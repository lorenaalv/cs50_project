{% extends "layout.html" %}
{% block main %}

<!-- Map Container -->
<div id="map"></div>

<!-- Purchase Table -->
<table class="table-center">
    <!-- Your table structure -->
</table>

<script>
    // Initialize and add the map
    function initMap() {
        // The map, centered at a default location
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 4,
            center: {lat: 37.0902, lng: -95.7129} // Change to a relevant default location
        };
        var map = new google.maps.Map(document.getElementById('map'), mapOptions);

        // Array of locations from Flask
        var locations = {{ purchases | tojson | safe }};

        // Place a marker for each location
        locations.forEach(function(purchase) {
            if (purchase.latitude && purchase.longitude) {
                var marker = new google.maps.Marker({
                position: new google.maps.LatLng(parseFloat(purchase.latitude), parseFloat(purchase.longitude)), // Replace with actual lat, lng from purchase
                map: map,
                title: purchase.item + ' - ' + purchase.location // or any other title you want to display
            });

            }
        });
    }
</script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAw6k0C6dfwFNSTgGlvYIcygXe3sDyHCa4&callback=initMap">
</script>

{% endblock %}
